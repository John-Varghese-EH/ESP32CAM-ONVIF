#pragma once

// ESP32-CAM ONVIF Web Interface - Auto-generated
// Built: 2026-01-19 17:48:06 | Size: 19,245 bytes
// Edit files in ESP32CAM-ONVIF/data/ then run: python utils/build_web.py

const char index_html[] PROGMEM = R"rawliteral(<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><title>ESP32-CAM ONVIF</title><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="theme-color" content="#000000"><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet"><link rel="icon" href="data:,"><style>:root{--bg-color:#050510;--glass-bg:rgba(255,255,255,0.05);--glass-border:rgba(255,255,255,0.1);--glass-blur:20px;--primary:#6366f1;--primary-glow:rgba(99,102,241,0.6);--accent:#d946ef;--accent-glow:rgba(217,70,239,0.5);--text-main:#f8fafc;--text-muted:#94a3b8;--success:#10b981;--danger:#ef4444;--radius:16px}*{box-sizing:border-box;-webkit-tap-highlight-color:transparent}body{font-family:'Inter',sans-serif;background:var(--bg-color);background-image:radial-gradient(circle at 10% 20%,rgba(99,102,241,0.25),transparent 40%),radial-gradient(circle at 90% 80%,rgba(217,70,239,0.35),transparent 40%),radial-gradient(circle at 50% 50%,rgba(139,92,246,0.1),transparent 60%);color:var(--text-main);margin:0;min-height:100vh;display:flex;flex-direction:column;overflow-x:hidden}.glass-panel{background:var(--glass-bg);backdrop-filter:blur(var(--glass-blur));-webkit-backdrop-filter:blur(var(--glass-blur));border:1px solid var(--glass-border);border-radius:var(--radius)}header{position:sticky;top:0;z-index:100;padding:1rem 1.5rem;display:flex;justify-content:space-between;align-items:center;background:rgba(5,5,16,0.8);backdrop-filter:blur(12px);border-bottom:1px solid var(--glass-border)}.brand{font-size:1.25rem;font-weight:700;background:linear-gradient(135deg,#fff 0%,#94a3b8 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;display:flex;align-items:center;gap:8px}.status-pill{font-size:0.75rem;padding:4px 12px;border-radius:99px;background:rgba(16,185,129,0.1);color:var(--success);border:1px solid rgba(16,185,129,0.2);font-weight:600;display:flex;align-items:center;gap:6px}.status-pill.offline{background:rgba(239,68,68,0.1);color:var(--danger);border-color:rgba(239,68,68,0.2)}.dot{width:6px;height:6px;border-radius:50%;background:currentColor}.pulse{animation:pulse 2s infinite}@keyframes pulse{0%{opacity:1}50%{opacity:0.5}100%{opacity:1}}main{flex:1;width:100%;max-width:1200px;margin:0 auto;padding:1.5rem}.tabs{display:flex;gap:8px;margin-bottom:1.5rem;overflow-x:auto;padding-bottom:4px;scrollbar-width:none}.tabs::-webkit-scrollbar{display:none}.tab-btn{background:transparent;border:none;color:var(--text-muted);padding:8px 16px;border-radius:12px;font-weight:500;cursor:pointer;transition:all 0.2s;white-space:nowrap}.tab-btn.active{background:rgba(255,255,255,0.1);color:#fff;box-shadow:0 4px 12px rgba(0,0,0,0.1)}.video-container{position:relative;background:#000;border-radius:var(--radius);overflow:hidden;aspect-ratio:16/9;box-shadow:0 20px 40px -10px rgba(0,0,0,0.5);border:1px solid var(--glass-border);margin-bottom:2rem}.video-feed{width:100%;height:100%;object-fit:contain;display:block}.video-controls{position:absolute;bottom:0;left:0;right:0;padding:1rem;background:linear-gradient(to top,rgba(0,0,0,0.9),transparent);display:flex;justify-content:center;gap:1rem;opacity:0;transition:opacity 0.3s ease}.video-container:hover .video-controls{opacity:1}@media(max-width:768px){.video-controls{opacity:1 !important;padding:0.8rem}}.video-container.fullscreen{position:fixed;top:0;left:0;width:100vw;height:100vh;z-index:1000;border-radius:0;margin:0}.btn{background:var(--glass-bg);border:1px solid var(--glass-border);color:var(--text-main);padding:10px 18px;border-radius:10px;font-weight:500;cursor:pointer;transition:all 0.2s;display:flex;align-items:center;justify-content:center;gap:8px;font-family:inherit}.btn:hover{background:rgba(255,255,255,0.1);transform:translateY(-1px)}.btn:active{transform:translateY(0)}.btn-primary{background:var(--primary);border-color:transparent;box-shadow:0 0 20px -5px var(--primary-glow)}.btn-primary:hover{background:#4f46e5;box-shadow:0 0 25px -5px var(--primary-glow)}.btn-icon{padding:8px;border-radius:50%;width:40px;height:40px}.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:1.5rem}.card{padding:1.5rem;display:flex;flex-direction:column;gap:1rem}.card h3{margin:0;font-size:1.1rem;font-weight:600;color:#fff;display:flex;align-items:center;gap:8px}.kv-group{display:flex;justify-content:space-between;align-items:center;padding:4px 0;border-bottom:1px solid rgba(255,255,255,0.05)}.kv-group:last-child{border:none}.label{color:var(--text-muted);font-size:0.9rem}.value{font-weight:500;font-family:monospace}.input-group{margin-bottom:0.5rem}.input-label{display:block;color:var(--text-muted);margin-bottom:6px;font-size:0.85rem}.form-control{width:100%;background:rgba(0,0,0,0.3);border:1px solid var(--glass-border);color:#fff;padding:10px;border-radius:8px;font-family:inherit}.form-control:focus{outline:none;border-color:var(--primary)}input[type=range]{width:100%;height:4px;background:rgba(255,255,255,0.1);border-radius:2px;-webkit-appearance:none}input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;width:16px;height:16px;border-radius:50%;background:var(--primary);cursor:pointer;box-shadow:0 0 10px var(--primary)}.wifi-item{display:flex;justify-content:space-between;align-items:center;padding:12px;background:rgba(255,255,255,0.03);border-radius:8px;margin-bottom:8px}.wifi-sig{font-size:0.8rem;color:var(--text-muted)}.panel{display:none;animation:fade 0.3s ease}.panel.active{display:block}@keyframes fade{from{opacity:0;transform:translateY(5px)}to{opacity:1;transform:translateY(0)}}.rec-toast{position:absolute;bottom:80px;left:50%;transform:translateX(-50%);background:rgba(16,185,129,0.9);color:white;padding:8px 16px;border-radius:20px;font-size:0.85rem;font-weight:500;opacity:0;transform:translateX(-50%) translateY(10px);transition:all 0.3s ease;pointer-events:none;backdrop-filter:blur(4px);box-shadow:0 4px 12px rgba(0,0,0,0.2);z-index:20}.rec-toast.show{opacity:1;transform:translateX(-50%) translateY(0)}@media(max-width:600px){main{padding:1rem}.grid{grid-template-columns:1fr}}</style></head><body><header><div class="brand"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z" /><circle cx="12" cy="13" r="4" /></svg> ESP32-CAM ONVIF <sub>Web Interface</sub></div><div class="status-pill" id="status-pill"><div class="dot pulse"></div><span id="status-text">Connecting...</span></div></header><main><div class="tabs"><button class="tab-btn active" onclick="setTab('dash')">Dashboard</button><button class="tab-btn" onclick="setTab('cam')">Camera</button><button class="tab-btn" onclick="setTab('net')">Network</button><button class="tab-btn" onclick="setTab('sys')">System</button></div><div id="tab-dash" class="panel active"><div class="video-container glass-panel" id="vcont"><img id="stream" class="video-feed" src="" alt="Connecting..." crossorigin="anonymous"><div id="rec-toast" class="rec-toast">Recording Started</div><div class="video-controls"><button class="btn btn-icon glass-panel" onclick="toggleStream()" title="Play/Pause">‚èØ</button><button class="btn btn-icon glass-panel" id="btn-record" onclick="toggleRecord()" title="Record" style="color:var(--danger)">üî¥</button><button class="btn btn-icon glass-panel" onclick="snap()" title="Snapshot">üì∏</button><button class="btn btn-icon glass-panel" id="btn-flash" onclick="toggleFlash()" title="Flash">‚ö°</button><button class="btn btn-icon glass-panel" onclick="toggleFS()" title="Fullscreen">‚õ∂</button></div></div><div class="grid"><div class="card glass-panel"><h3>System Status</h3><div class="kv-group"><span class="label">Uptime</span><span class="value" id="val-uptime">-</span></div><div class="kv-group"><span class="label">Heap Free</span><span class="value" id="val-heap">-</span></div><div class="kv-group"><span class="label">WiFi Signal</span><span class="value" id="val-rssi">-</span></div><div class="kv-group"><span class="label">Motion</span><span class="value" id="val-motion">-</span></div></div><div class="card glass-panel"><h3>Recording Settings</h3><div class="kv-group"><span class="label">Storage Location</span><select class="form-control" style="width:auto" id="rec-mode"><option value="device">Device (Client)</option><option value="sd">SD Card (Server)</option></select></div><div class="kv-group" id="sd-rec-status-row" style="display:none"><span class="label">SD Status</span><span class="value" id="sd-status">Ready</span></div></div></div></div><div id="tab-cam" class="panel"><div class="grid"><div class="card glass-panel"><h3>Image Settings</h3><div class="input-group"><span class="input-label">Resolution</span><select class="form-control" onchange="cfg('resolution', this.value)"><option value="FRAMESIZE_UXGA">UXGA (1600x1200)</option><option value="FRAMESIZE_SXGA">SXGA (1280x1024)</option><option value="FRAMESIZE_HD">HD (1280x720)</option><option value="FRAMESIZE_VGA" selected>VGA (640x480) [Rec.]</option><option value="FRAMESIZE_QVGA">QVGA (320x240)</option><option value="FRAMESIZE_QQVGA">QQVGA (160x120)</option></select></div><div class="input-group"><div class="flex-row" style="margin-bottom:4px;display:flex;justify-content:space-between"><span class="input-label">Quality (Lower is Better)</span><span class="value" id="lbl-qual">12</span></div><input type="range" min="4" max="63" value="12" oninput="el('lbl-qual').innerText=this.value" onchange="cfg('quality', this.value)"></div><div class="input-group"><span class="input-label">Brightness</span><input type="range" min="-2" max="2" value="0" onchange="cfg('brightness', this.value)"></div><div class="input-group"><span class="input-label">Contrast</span><input type="range" min="-2" max="2" value="0" onchange="cfg('contrast', this.value)"></div></div><div class="card glass-panel"><h3>Advanced</h3><div class="kv-group"><span>Auto Flash (Night Mode)</span><input type="checkbox" id="chk-autoflash" onchange="api('/api/autoflash', {method:'POST', body:JSON.stringify({enabled:this.checked})})"></div><div class="kv-group"><span>Vertical Flip</span><input type="checkbox" onchange="cfg('vflip', this.checked ? 1 : 0)"></div><div class="kv-group"><span>Horizontal Mirror</span><input type="checkbox" onchange="cfg('hmirror', this.checked ? 1 : 0)"></div><div class="kv-group"><span>Auto Exposure</span><input type="checkbox" checked onchange="cfg('aec', this.checked ? 1 : 0)"></div></div><div class="card glass-panel" style="border-left: 4px solid var(--primary)"><h3>ONVIF Settings</h3><div class="kv-group"><span>Enable ONVIF Service</span><input type="checkbox" id="chk-onvif" checked onchange="api('/api/onvif/toggle', {method:'POST', body:JSON.stringify({enabled:this.checked})})"></div></div></div></div><div id="tab-net" class="panel"><div class="card glass-panel" style="max-width: 600px; margin: 0 auto;"><h3>WiFi Manager</h3><div style="background: rgba(0,0,0,0.2); padding: 1rem; border-radius: 8px; margin-bottom: 1rem;"><div class="kv-group"><span class="label">SSID</span><span class="value" id="wifi-ssid">...</span></div><div class="kv-group"><span class="label">IP Address</span><span class="value" id="wifi-ip">...</span></div></div><button class="btn btn-primary" style="width:100%" onclick="scanWifi()" id="btn-scan">Scan Networks</button><div id="wifi-list" style="margin-top: 1rem;"></div></div></div><div id="tab-sys" class="panel"><div class="grid"><div class="card glass-panel"><h3>Firmware Update</h3><p class="label">Upload .bin file to update firmware</p><input type="file" id="ota-file" class="form-control" accept=".bin" style="margin-bottom: 1rem"><div style="height: 6px; background: rgba(255,255,255,0.1); border-radius: 3px; overflow:hidden; margin-bottom: 1rem"><div id="ota-bar" style="width:0%; height:100%; background: var(--primary); transition: width 0.2s"></div></div><button class="btn btn-primary" onclick="startOTA()">Start Update</button></div><div class="card glass-panel"><h3>Power & Storage</h3><button class="btn" style="margin-bottom:0.5rem" onclick="window.open('/api/sd/list','_blank')">üìÇ Browse SD Card</button><button class="btn" style="margin-bottom:0.5rem" onclick="api('/api/time',{method:'POST',body:JSON.stringify({epoch:Math.floor(Date.now()/1000)})}).then(()=>alert('Synced!'))">üïí Sync Time</button><button class="btn" style="color:var(--danger); border-color:rgba(239,68,68,0.3)" onclick="if(confirm('Reboot device?')) api('/reboot',{method:'POST'}).then(()=>alert('Rebooting... Device will restart.'))">üîÑ Reboot Device</button></div></div></div></main><script>const el=i=>document.getElementById(i);const api=async (ep,opts={})=>{try{const r=await fetch(ep,opts);if(!r.ok) throw new Error(r.statusText);return r.json();}catch(e){console.error(e);return null;}};function showToast(msg){const t=el('rec-toast');t.innerText=msg;t.classList.add('show');setTimeout(()=>t.classList.remove('show'),3000);}function setTab(id){document.querySelectorAll('.panel').forEach(p=>p.classList.remove('active'));document.querySelectorAll('.tab-btn').forEach(b=>b.classList.remove('active'));el('tab-'+id).classList.add('active');event.target.classList.add('active');if(id==='net') updateWifi();}function toggleStream(){const img=el('stream');if (img.src.includes('/stream')){img.src="";img.alt="Paused";el('status-text').innerText="Paused";}else{img.src="/stream?t="+Date.now();img.alt="Connecting...";el('status-text').innerText="Connecting...";}}function snap(){const a=document.createElement('a');a.href='/snapshot';a.download=`snap_${Date.now()}.jpg`;a.click();}let isRecording=false;let mediaRecorder;let recordedChunks=[];let recCanvas,recCtx,recLoop;async function toggleRecord(){const mode=el('rec-mode').value;const btn=el('btn-record');if (!isRecording){if (mode==='device'){startClientRecord();showToast("Video saving to Device ‚¨áÔ∏è");}else{await api('/api/record',{method:'POST',body:JSON.stringify({action:'start'})});showToast("Recording to SD Card üíæ");}isRecording=true;btn.innerHTML='‚¨õ';btn.classList.add('pulse');}else{if (mode==='device'){stopClientRecord();}else{await api('/api/record',{method:'POST',body:JSON.stringify({action:'stop'})});showToast("Recording Stopped");}isRecording=false;btn.innerHTML='üî¥';btn.classList.remove('pulse');}}function startClientRecord(){const img=el('stream');let w=img.naturalWidth;let h=img.naturalHeight;if (w===0||h===0){console.warn("Stream not fully loaded,using default 640x480");w=640;h=480;}recCanvas=document.createElement('canvas');recCanvas.width=w;recCanvas.height=h;recCtx=recCanvas.getContext('2d');console.log(`Starting Local Rec:${w}x${h}`);const draw=()=>{if(!isRecording) return;if (img.complete&&img.naturalWidth>0){recCtx.drawImage(img,0,0,w,h);}requestAnimationFrame(draw);};draw();const stream=recCanvas.captureStream(20);let mime='video/webm';let ext='webm';if (MediaRecorder.isTypeSupported('video/mp4')){mime='video/mp4';ext='mp4';}else if (MediaRecorder.isTypeSupported('video/webm;codecs=vp9')){mime='video/webm;codecs=vp9';}console.log("Recording using:",mime);try{mediaRecorder=new MediaRecorder(stream,{mimeType:mime});}catch (e){console.error("MediaRecorder fail,trying default:",e);mediaRecorder=new MediaRecorder(stream);ext='webm';}recordedChunks=[];mediaRecorder.ondataavailable=e=>{if (e.data.size>0) recordedChunks.push(e.data);};mediaRecorder.onstop=()=>{const blob=new Blob(recordedChunks,{type:mime});const url=URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download=`rec_${Date.now()}.${ext}`;a.click();URL.revokeObjectURL(url);showToast(`Saved as .${ext.toUpperCase()}`);};mediaRecorder.start();}function stopClientRecord(){if(mediaRecorder&&mediaRecorder.state!=='inactive'){mediaRecorder.stop();}}let flash=false;function toggleFlash(){flash=!flash;el('btn-flash').style.color=flash?'#fbbf24':'white';api('/api/flash',{method:'POST',body:JSON.stringify({state:flash})});}function toggleFS(){const c=el('vcont');if(!document.fullscreenElement){c.requestFullscreen().catch(e=>console.log(e));c.classList.add('fullscreen');}else{document.exitFullscreen();c.classList.remove('fullscreen');}}document.addEventListener('fullscreenchange',()=>{if(!document.fullscreenElement) el('vcont').classList.remove('fullscreen');});function cfg(k,v){api('/api/config',{method:'POST',body:JSON.stringify({[k]:v})});}async function updateWifi(){const d=await api('/api/wifi/status');if(d){el('wifi-ssid').innerText=d.ssid;el('wifi-ip').innerText=d.ip;}}async function scanWifi(){el('btn-scan').innerText="Scanning...";const d=await api('/api/wifi/scan');el('btn-scan').innerText="Scan Networks";if(d&&d.networks){el('wifi-list').innerHTML=d.networks.map(n=>`<div class="wifi-item"><div><b>${n.ssid}</b><span class="wifi-sig">${n.rssi}dBm</span></div><button class="btn" style="padding:4px 10px;font-size:0.8rem" onclick="connect('${n.ssid}')">Connect</button></div>`).join('');}}function connect(ssid){const p=prompt('Password for '+ssid);if(p) api('/api/wifi/connect',{method:'POST',body:JSON.stringify({ssid,password:p})});}function startOTA(){const f=el('ota-file').files[0];if(!f) return alert('Select file');const fd=new FormData();fd.append("update",f);const xhr=new XMLHttpRequest();xhr.upload.onprogress=e=>el('ota-bar').style.width=Math.round((e.loaded/e.total)*100)+'%';xhr.onload=()=>alert(xhr.status===200?'Success!Rebooting...':'Failed');xhr.open("POST","/api/update");xhr.send(fd);}async function updateStatus(){const d=await api('/api/status');if(d){el('status-pill').classList.remove('offline');el('status-text').innerText="Online";el('val-uptime').innerText=Math.floor(d.uptime/60)+"m";el('val-heap').innerText=Math.round(d.heap/1024)+"KB";if(el('chk-autoflash')) el('chk-autoflash').checked=d.autoflash;if(el('chk-onvif')) el('chk-onvif').checked=d.onvif_enabled;const sdOpt=el('rec-mode').querySelector('option[value="sd"]');if (sdOpt){if (!d.sd_mounted){sdOpt.disabled=true;sdOpt.innerText="SD Card (Not Found)";if(el('rec-mode').value==='sd') el('rec-mode').value='device';}else{sdOpt.disabled=false;sdOpt.innerText="SD Card (Server)";}}if(el('rec-mode').value==='sd'){el('sd-rec-status-row').style.display='flex';el('sd-status').innerText=d.recording?"Recording...":"Ready";if(d.recording&&!isRecording){isRecording=true;el('btn-record').innerHTML='‚¨õ';el('btn-record').classList.add('pulse');}else if (!d.recording&&isRecording&&el('rec-mode').value==='sd'){isRecording=false;el('btn-record').innerHTML='üî¥';el('btn-record').classList.remove('pulse');}}else{el('sd-rec-status-row').style.display='none';}}else{el('status-pill').classList.add('offline');el('status-text').innerText="Offline";}}setInterval(updateStatus,2000);const streamImg=el('stream');streamImg.onerror=()=>{console.log("Stream error/disconnect. Retrying...");el('status-text').innerText="Reconnecting...";el('status-pill').classList.add('offline');setTimeout(()=>{if (streamImg.src.includes('/stream')){streamImg.src='/stream?t='+Date.now();}},2000);};streamImg.onload=()=>{el('status-pill').classList.remove('offline');el('status-text').innerText="Online";};window.onload=()=>{el('stream').src='/stream?t='+Date.now();updateStatus();updateWifi();}</script></body></html>)rawliteral";
